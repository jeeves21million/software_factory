{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://software-factory-agents/contracts/agents/ui_design_agent.input.schema.json",
  "title": "ui_design_agent Input",
  "type": "object",
  "additionalProperties": false,
  "required": ["job", "payload"],
  "properties": {
    "job": { "$ref": "../common/job_envelope.schema.json" },
    "payload": {
      "type": "object",
      "additionalProperties": false,
      "required": ["design_brief", "inspirations", "required_screens", "output_spec", "quality_gate"],
      "properties": {
        "design_brief": {
          "type": "object",
          "additionalProperties": false,
          "required": ["overview", "design_direction", "required_screens"],
          "properties": {
            "overview": { "type": "string", "minLength": 1 },
            "design_direction": {
              "type": "array",
              "minItems": 3,
              "items": { "type": "string", "minLength": 1 }
            },
            "required_screens": {
              "type": "array",
              "minItems": 1,
              "uniqueItems": true,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["id", "name", "purpose", "priority"],
                "properties": {
                  "id": {
                    "type": "string",
                    "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$"
                  },
                  "name": { "type": "string", "minLength": 1 },
                  "purpose": { "type": "string", "minLength": 1 },
                  "priority": { "type": "string", "enum": ["critical", "high", "medium", "low"] }
                }
              }
            }
          }
        },
        "inspirations": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["type", "comment"],
            "properties": {
              "type": { "type": "string", "enum": ["link", "image", "comment"] },
              "value": { "type": "string" },
              "comment": { "type": "string", "minLength": 1 }
            }
          }
        },
        "brand_pack": { "type": "object" },
        "brand_foundation": { "type": "object" },
        "required_screens": {
          "type": "array",
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string",
            "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$"
          }
        },
        "accessibility_target": { "type": "string" },
        "output_spec": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "format",
            "framework",
            "language",
            "bundler",
            "styling",
            "router",
            "state_library",
            "required_viewports",
            "app_root",
            "routes_manifest_file",
            "quality_report_file",
            "component_registry_file",
            "state_model_file"
          ],
          "properties": {
            "format": { "type": "string", "const": "react_spa" },
            "framework": { "type": "string", "const": "react" },
            "language": { "type": "string", "const": "typescript" },
            "bundler": { "type": "string", "const": "vite" },
            "styling": { "type": "string", "const": "tailwindcss" },
            "router": { "type": "string", "const": "react-router-dom" },
            "state_library": { "type": "string", "const": "zustand" },
            "required_viewports": {
              "type": "array",
              "minItems": 2,
              "items": { "type": "string", "enum": ["desktop", "mobile"] },
              "allOf": [
                { "contains": { "const": "desktop" } },
                { "contains": { "const": "mobile" } }
              ]
            },
            "app_root": { "type": "string", "minLength": 1 },
            "routes_manifest_file": { "type": "string", "minLength": 1 },
            "quality_report_file": { "type": "string", "minLength": 1 },
            "component_registry_file": { "type": "string", "minLength": 1 },
            "state_model_file": { "type": "string", "minLength": 1 }
          }
        },
        "quality_gate": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "tier",
            "require_full_screen_coverage",
            "require_responsive_behavior",
            "forbid_placeholder_copy",
            "require_interaction_states",
            "require_accessibility_assertions",
            "require_local_mock_data",
            "require_no_live_api_calls",
            "minimum_uniqueness_score"
          ],
          "properties": {
            "tier": { "type": "string", "enum": ["premium"] },
            "require_full_screen_coverage": { "type": "boolean", "const": true },
            "require_responsive_behavior": { "type": "boolean", "const": true },
            "forbid_placeholder_copy": { "type": "boolean", "const": true },
            "require_interaction_states": {
              "type": "array",
              "items": { "type": "string", "enum": ["loading", "empty", "error", "success"] },
              "allOf": [
                { "contains": { "const": "loading" } },
                { "contains": { "const": "empty" } },
                { "contains": { "const": "error" } },
                { "contains": { "const": "success" } }
              ]
            },
            "require_accessibility_assertions": {
              "type": "array",
              "minItems": 1,
              "items": { "type": "string", "minLength": 1 }
            },
            "require_local_mock_data": { "type": "boolean", "const": true },
            "require_no_live_api_calls": { "type": "boolean", "const": true },
            "minimum_uniqueness_score": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
          },
          "allOf": [
            {
              "properties": {
                "minimum_uniqueness_score": { "minimum": 0.75 }
              },
              "required": ["minimum_uniqueness_score"]
            }
          ]
        }
      },
      "anyOf": [
        { "required": ["brand_pack"] },
        { "required": ["brand_foundation"] }
      ]
    }
  }
}
